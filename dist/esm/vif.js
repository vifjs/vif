const t=(t,n,s,o)=>{const r=n.handler||(n.handler=new e);r[o]=s(t.t),n.addEventListener(o,r)};class e{handleEvent(t){this[t.type](t)}}let n={},s=null;const o=t=>{n[t]&&(n[t](),n[t]=!1)},r=t=>{n={...t,...n},s=o},c=document,l=t=>c.createElement(t),i=(t,e)=>t.cloneNode(e),u=t=>t.children,a=t=>t.o||t.children,f=(t,e)=>t.name.substring(e),p=t=>0===t.name.indexOf("x-"),h=t=>0===t.tagName.indexOf("X-"),d=t=>!!t.content,x=t=>!!tt[t.tagName]||d(t),m={l(t){let e=this;e.t||(e.t=t||{}),e.i||(e.i=new Set)},u(){this.p()},h(t,e,n){let o=this,r=e.length-1,c=n;for(;r>=0;){const l=e[r],i=t[l.m];if(l.v&&(i.S=l.$,(n||o.i).add(i),s&&s(i.tagName)),!n)for(const[t,e]of l.O){const n=e.j(o,i,e.k,t);n&&o.i.add(n)}if(l.$){(!l.v||(c=!x(i)&&(i.i=new Set)))&&o.h(a(i),l.$,c)}r--}},p(){for(const t of this.i)t.u&&t.u();this.i.clear()}};function v(t){this.l(t)}v.prototype=m;let w=null;const g=t=>{const e=t=>{if(void 0!==t){e.value=t;for(const t of e.C)t()}else w&&(e.C.add(w),w.L.add(e.C));return e.value};return e.value=t,e.M=!0,e.C=new Set,e.effect=e.C,e},y=t=>{const e=w;return w=t,w.L=new Set,w.u=(t=>()=>{for(const e of t.L)e.delete(t)})(w),t(),w=e,t};let b=c.createComment(""),E=l("template"),S=c.createDocumentFragment();const $=()=>{},O=(t,...e)=>t.reduce(((n,s,o)=>n+(s+(o===t.length-1?"":e[o]))),""),j=l("style"),k="css-x";let C=1;const L=(t,e)=>"$"+(e||C)+t,M=(t,...e)=>{if("string"==typeof t)return`${k}="${L(t,C)}"`;{const n=O(t,e);j.textContent+=n,j.parentElement||c.head.appendChild(j)}},V=(t,e,n)=>{const s=n,o=t.V;e.setAttribute(k,L(s,o))},H=(t,e,n)=>{const s=n,o=t.H(s);let r=!0;return y((()=>{const t=o();if(r){for(const n of t)n(e);r=!1}else t[t.length-1](e)}))},R=(t,e,n)=>{const s=e.style.display;return y((()=>{n(t.t)?s?e.style.display=s:e.style.removeProperty("display"):e.style.display="none"}))},U=(t,e,n)=>y((()=>e.textContent=n(t.t))),X=(t,e,n,s)=>y((()=>e.setAttribute(s,n(t.t)))),D=t=>"x-text"===t?U:"x-show"===t?R:"x-ref"===t?H:"x-css"===t?V:X,I=(t,e,n,s)=>{e.t||(e.t={});let o=null;const r={R:(t,e)=>o={U:t,X:e}},c=y((()=>{const o=e.t[s],c=n(t.t);o&&o.M?r.R(o,c):e.t[s]=c}));return o&&o.U(o.X),r.R=(t,e)=>t(e),c},N={},T=t=>{if(N[t])return N[t];let e=Object.getPrototypeOf((function(){})).constructor,n=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(()=>{ ${t} })()`:t;let s=(()=>{try{let s=new e(["scope"],`with(scope){return ${n}};`);return Object.defineProperty(s,"name",{value:`VifExp "${t}"`}),s}catch(e){return console.error("VifExp error : "+t,e),!1}})();return N[t]=s,s},q=(t,e,n)=>{Y(e);let s=[];const o="item",r=e.getAttribute(o)||o;return y((()=>{const o=n(t.t);((t,e,n,s,o)=>{let r=0;const c=n.length,l=s.length;let i=l-c;for(;r<c&&r<l;)n[r]!==s[r]&&Q(e,r,s[r]),r++;for(;i>0;)P(e,t,r,o,s[r]),i--,r++;for(;i<0;)W(e,r),i++,r++})(t.t,e,s,o,r),s=o.slice()}))},z=(t,e,n)=>{Y(e);let s=!1;return y((()=>{const o=!!n(t.t);o!==s&&(s=o,o?P(e,t.t,0):W(e,0))}))};let A=location;const B=()=>A.pathname+A.search,F=g(B());addEventListener("popstate",(()=>{A=location,F(B())}));const G=t=>{if("string"==typeof t){const e=new URL(t,A);if(A.href!==e.href)return A=e,history.pushState({},"",A),F(B())}else{t.preventDefault();const e=t.currentTarget.href;if(e)return G(e)}};G.route=F;const J=(t,e,n)=>{Y(e);const s=new RegExp(n||"."),o="params",r=e.getAttribute(o)||o;let c=null;return y((()=>{const n=F().match(s)||null;n!==c&&(n&&c?Q(e,0,n):n?P(e,t.t,0,r,n):W(e,0)),c=n}))},K=()=>i(b),P=(t,e,n,s,o)=>{const r=t.D;let c=r[n+1];const l=i(t.content,!0);c?c.U&&c.U(o):c=r[n+1]=((t,e,n,s)=>{const o=K(),r=n&&g(s);return r&&(r.index=e),{I:o,N:new v(n?{...t,[n]:r}:t),U:r}})(e,n,s,o),t.S&&c.N.h(u(l),t.S),r[n].I.replaceWith(r[n].I,l,c.I)},Q=(t,e,n)=>{t.D[e+1].U(n)},W=(t,e)=>{const n=t.D;let s=n[e].I.nextSibling;const o=n[e+1].I;for(n[e+1].N.u();s!==o;){const t=s;s=s.nextSibling,t.remove()}},Y=t=>{t.D=[{I:K()}],t.u=()=>{for(let e=1;e<t.D.length;e++)t.D[e].N.u()},t.replaceWith(t.D[0].I)},Z=e=>{const n=[];for(let o=0;o<e.length;o++){let r=e[o];const c=d(r),l=!c&&h(r),i={m:o,$:!1,v:c||l,O:new Map};let u=r.attributes.length;for(;u--;){const e=r.attributes[u];if(p(e)){const n=0===e.name.indexOf("x-on:"),o=f(e,n?5:2),u={k:"ref"===o||"css"===o||"route"===o?e.value:T(e.value||""),j:l?I:c?"x-for"===(s=e.name)?q:"x-if"===s?z:"x-route"===s?J:void 0:n?t:D(e.name)};i.O.set(o,u),!l&&r.removeAttribute(e.name)}}const x=a(r=r.content||r);x.length&&(i.$=Z(x)),(i.O.size||i.$||l)&&n.push(i)}var s;return n.length>0&&n};class _ extends HTMLElement{constructor(){super(),this.l(),this.T={}}onMount(){}connectedCallback(){let t=this,e=t.t;for(const n of t.attributes)if(p(n)){const t=f(n,2);e[t]=g(e[t])}else e[n.name]=n.value||!0;t.useRef=t.H,t.onMount({props:e}),t.q()}onUnmount(){}u(){let t=this;t.onUnmount({props:t.t}),t.p()}q(){let t=this;const e=t.A;let n=e.B,s=e.$,o=e.V;const r=n?$:O,c=o?$:M,l=e.F,a={html:r,css:c,props:t.t},f=l.call(t,a);if(f&&("string"==typeof f?(n=e.B=(t=>{let e=i(E);return e.innerHTML=t,e.content})(f),s=e.$=Z(u(n))):(n=f===t?t:(t=>{let e=i(S);return e.append(...t),e})(f),s=t.S||Z(t.o||u(n)))),t.V=e.V=o||C++,e.B&&(n=i(n,!0)),s&&t.h(t.o||u(n),s),n!==t){const e=t.parentNode;e.o||(e.o=[].slice.call(u(e))),t.replaceWith(n)}}H(t,e,n){const s=this.T,o=s[t]||(s[t]=g([]));if(!e)return o;{const t=o.value;n?t[(t.length||1)-1]=e:t.push(e),o(t)}}}Object.assign(_.prototype,m);const tt={},et=(t,e)=>{const n="X-"+t.toUpperCase();return tt[n]=class extends _{constructor(){super()}},tt[n].F=e,tt[n].prototype.A=tt[n],customElements.define(`x-${t}`,tt[n]),tt[n]};let nt,st,ot=[];const rt=g(),ct=g(),lt=(t,e)=>t[e]||t[t.default],it=t=>t?(nt=t,rt(rt.value||localStorage.getItem("locale")||navigator.language),void(st||(st=y((()=>{const[t,e]=rt().split("-"),n=lt(lt(nt,t),e);n&&n().then((t=>{ct(t.default),ot&&(ot=ot.forEach((t=>t())))}))}))))):ct();it.locale=rt,it.onload=t=>{ct()?t():ot.push(t)};export{et as useDefine,it as useI18n,G as useNavigate,r as useObserve,g as useSignal};
